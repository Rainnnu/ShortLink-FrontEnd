{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport request from \"../utils/request\";\nexport default {\n  data() {\n    return {\n      isPasswordLogin: true,\n      isLoginFormVisible: true,\n      isNewPasswordInputVisible: false,\n      isForgotPasswordFormVisible: false,\n      loginForm: {\n        email: \"\",\n        password: \"\",\n        verificationCode: \"\"\n      },\n      forgotPasswordForm: {\n        email: \"\",\n        verificationCode: \"\",\n        newPassword: \"\"\n      },\n      loginFormRules: {\n        email: [{\n          required: true,\n          message: \"请输入邮箱\",\n          trigger: \"blur\"\n        }, {\n          pattern: /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/,\n          message: \"邮箱格式不正确\",\n          trigger: \"blur\"\n        }],\n        password: [{\n          required: true,\n          message: \"请输入密码\",\n          trigger: \"blur\"\n        }],\n        verificationCode: [{\n          required: true,\n          message: \"请输入验证码\",\n          trigger: \"blur\"\n        }, {\n          min: 6,\n          max: 6,\n          message: \"验证码长度必须为6\",\n          trigger: \"blur\"\n        }]\n      },\n      forgotPasswordFormRules: {\n        email: [{\n          required: true,\n          message: \"请输入邮箱\",\n          trigger: \"blur\"\n        }, {\n          pattern: /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/,\n          message: \"邮箱格式不正确\",\n          trigger: \"blur\"\n        }],\n        verificationCode: [{\n          required: true,\n          message: \"请输入验证码\",\n          trigger: \"blur\"\n        }, {\n          min: 6,\n          max: 6,\n          message: \"验证码长度必须为6\",\n          trigger: \"blur\"\n        }],\n        newPassword: [{\n          required: true,\n          message: \"请输入新密码\",\n          trigger: \"blur\"\n        }]\n      },\n      isSendingCode: false,\n      // 登录验证码发送状态\n      isSendingVerifyCode: false,\n      // 忘记密码的验证码发送状态\n      countdown: 60,\n      countdownVerify: 60,\n      sentCodeTime: null,\n      // 登录验证码发送时间\n      verifyCodeTime: null // 忘记密码的验证码发送时间\n    };\n  },\n  methods: {\n    submitLogin() {\n      this.$refs.loginFormRef.validate(valid => {\n        if (valid) {\n          if (!this.isPasswordLogin) {\n            const currentTime = Date.now();\n            if (this.sentCodeTime && currentTime - this.sentCodeTime > 60 * 1000) {\n              this.$message.error(\"验证码已过期，请重新获取\");\n              return;\n            }\n          }\n          this.login();\n        } else {\n          console.log(\"表单校验不通过\");\n          return false;\n        }\n      });\n    },\n    submitResetPassword() {\n      this.$refs.forgotPasswordFormRef.validate(valid => {\n        if (valid) {\n          const currentTime = Date.now();\n          if (this.verifyCodeTime && currentTime - this.verifyCodeTime > 60 * 1000) {\n            this.$message.error(\"验证码已过期，请重新获取\");\n            return;\n          }\n          this.resetPassword();\n        } else {\n          console.log(\"表单校验不通过\");\n          return false;\n        }\n      });\n    },\n    login() {\n      if (this.isPasswordLogin) {\n        // 密码登录\n        request.post(\"/users/loginByPassword\", {\n          email: this.loginForm.email,\n          password: this.loginForm.password\n        }).then(response => {\n          if (response.code === 200) {\n            const {\n              refreshToken,\n              accessToken\n            } = response.data;\n            //删去临时token\n            localStorage.removeItem(\"templeAccessToken\");\n            // 存储 refreshToken 到 localStorage\n            localStorage.setItem(\"refreshToken\", refreshToken);\n            // 存储 accessToken 到 localStorage\n            localStorage.setItem(\"accessToken\", accessToken);\n            // 存储用户信息到 localStorage\n            localStorage.setItem(\"userEmail\", this.loginForm.email);\n            this.$message.success(\"登录成功\");\n            // 页面跳转\n            this.$router.push(\"/create\");\n          } else {\n            this.$message.error(response.msg);\n          }\n        }).catch(error => {\n          // 处理登录失败逻辑\n          console.log(error);\n          this.$message.error(\"登录失败!\");\n        });\n      } else {\n        // 验证码登录\n        request.post(\"/users/loginByEmail\", {\n          email: this.loginForm.email,\n          verificationCode: this.loginForm.verificationCode\n        }).then(response => {\n          if (response.code === 200) {\n            const {\n              refreshToken,\n              accessToken\n            } = response.data;\n            //删去临时token\n            localStorage.removeItem(\"templeAccessToken\");\n            // 存储 refreshToken 到 localStorage\n            localStorage.setItem(\"refreshToken\", refreshToken);\n            // 存储 accessToken 到 localStorage\n            localStorage.setItem(\"accessToken\", accessToken);\n            // 存储用户信息到 localStorage\n            localStorage.setItem(\"userEmail\", this.loginForm.email);\n            this.$message.success(\"登录成功\");\n            // 页面跳转\n            this.$router.push(\"/create\");\n          } else {\n            this.$message.error(response.msg);\n          }\n        }).catch(error => {\n          // 处理登录失败逻辑\n          console.log(error);\n          this.$message.error(\"登陆失败！\");\n        });\n      }\n    },\n    toggleLoginType() {\n      this.isPasswordLogin = !this.isPasswordLogin;\n      // 切换登录方式时重置验证码时间和状态\n      this.sentCodeTime = null;\n      this.isSendingCode = false;\n      this.countdown = 60;\n      this.loginForm.verificationCode = \"\";\n\n      // 重置表单校验状态\n      this.resetLoginFormValidation();\n    },\n    showForgotPassword() {\n      // 先重置登录表单校验\n      this.resetLoginFormValidation();\n      this.isLoginFormVisible = false;\n      this.isForgotPasswordFormVisible = true;\n      this.isNewPasswordInputVisible = false;\n\n      // 重置忘记密码表单\n      this.$nextTick(() => {\n        this.resetForgotPasswordFormValidation();\n        this.forgotPasswordForm = {\n          email: this.loginForm.email,\n          // 保留邮箱\n          verificationCode: \"\",\n          newPassword: \"\"\n        };\n      });\n    },\n    showLoginForm() {\n      // 先重置忘记密码表单校验\n      this.resetForgotPasswordFormValidation();\n      this.isLoginFormVisible = true;\n      this.isForgotPasswordFormVisible = false;\n      this.isNewPasswordInputVisible = false;\n\n      // 重置登录表单\n      this.$nextTick(() => {\n        this.resetLoginFormValidation();\n      });\n    },\n    // 新增方法：重置登录表单校验\n    resetLoginFormValidation() {\n      this.$nextTick(() => {\n        if (this.$refs.loginFormRef) {\n          this.$refs.loginFormRef.clearValidate();\n          // 如果想同时重置字段值，可以使用：\n          // this.$refs.loginFormRef.resetFields();\n        }\n      });\n    },\n    // 重置忘记密码表单校验\n    resetForgotPasswordFormValidation() {\n      this.$nextTick(() => {\n        if (this.$refs.forgotPasswordFormRef) {\n          this.$refs.forgotPasswordFormRef.clearValidate();\n          // 如果想同时重置字段值，可以使用：\n          // this.$refs.forgotPasswordFormRef.resetFields();\n        }\n      });\n    },\n    // 登录验证码\n    sendCode() {\n      if (this.isSendingCode) return;\n      this.isSendingCode = true;\n      request.post(`/users/email?email=${this.loginForm.email}`).then(response => {\n        // 处理发送验证码成功逻辑\n        if (response.code === 200) {\n          this.$message.success(\"验证码已发送\");\n          this.sentCodeTime = Date.now();\n          let timer = setInterval(() => {\n            if (this.countdown > 0) {\n              this.countdown--;\n            } else {\n              clearInterval(timer);\n              this.isSendingCode = false;\n              this.countdown = 60;\n            }\n          }, 1000);\n        } else {\n          this.isSendingCode = false;\n          this.$message.error(response.msg);\n        }\n      }).catch(error => {\n        // 处理发送验证码失败逻辑\n        this.$message.error(\"验证码发送失败，请稍后重试\");\n        this.isSendingCode = false;\n        this.countdown = 60;\n      });\n    },\n    //通过验证码登录\n    sendVerifyCode() {\n      if (this.isSendingVerifyCode) return;\n      this.isSendingVerifyCode = true;\n      request.post(`/users/email?email=${this.forgotPasswordForm.email}`).then(response => {\n        // 处理发送验证邮件成功逻辑\n        if (response.code == 200) {\n          this.$message.success(\"验证码已发送\");\n          this.verifyCodeTime = Date.now();\n          let timer = setInterval(() => {\n            if (this.countdownVerify > 0) {\n              this.countdownVerify--;\n            } else {\n              clearInterval(timer);\n              this.isSendingVerifyCode = false;\n              this.countdownVerify = 60;\n            }\n          }, 1000);\n        } else {\n          this.isSendingVerifyCode = false;\n          this.$message.error(response.msg);\n        }\n      }).catch(error => {\n        // 处理发送验证邮件失败逻辑\n        this.$message.error(\"验证邮件发送失败，请稍后重试\");\n        this.isSendingVerifyCode = false;\n        this.countdownVerify = 60;\n      });\n    },\n    submitVerifyCode() {\n      this.$refs.forgotPasswordFormRef.validate(valid => {\n        if (valid) {\n          // 检查验证码是否过期\n          const currentTime = Date.now();\n          if (this.verifyCodeTime && currentTime - this.verifyCodeTime > 60 * 1000) {\n            this.$message.error(\"验证码已过期，请重新获取\");\n            return;\n          }\n          request.put(\"/users/verify\", {\n            email: this.forgotPasswordForm.email,\n            verificationCode: this.forgotPasswordForm.verificationCode\n          }).then(response => {\n            if (response.code === 200) {\n              this.isNewPasswordInputVisible = true;\n              localStorage.setItem(\"templeAccessToken\", response.msg);\n            } else {\n              this.$message.error(response.msg);\n            }\n          }).catch(error => {\n            console.log(error);\n          });\n        } else {\n          console.log(\"表单校验不通过\");\n          return false;\n        }\n      });\n    },\n    resetPassword() {\n      request.put(`/users/resetPassword?password=${this.forgotPasswordForm.newPassword}`).then(response => {\n        // 处理重置密码成功逻辑\n        if (response.code === 200) {\n          this.isForgotPasswordFormVisible = false;\n          this.isLoginFormVisible = true;\n        } else {\n          this.$message.error(response.msg);\n        }\n      }).catch(error => {\n        // 处理重置密码失败逻辑\n        console.log(error);\n      });\n    }\n  }\n};","map":{"version":3,"names":["request","data","isPasswordLogin","isLoginFormVisible","isNewPasswordInputVisible","isForgotPasswordFormVisible","loginForm","email","password","verificationCode","forgotPasswordForm","newPassword","loginFormRules","required","message","trigger","pattern","min","max","forgotPasswordFormRules","isSendingCode","isSendingVerifyCode","countdown","countdownVerify","sentCodeTime","verifyCodeTime","methods","submitLogin","$refs","loginFormRef","validate","valid","currentTime","Date","now","$message","error","login","console","log","submitResetPassword","forgotPasswordFormRef","resetPassword","post","then","response","code","refreshToken","accessToken","localStorage","removeItem","setItem","success","$router","push","msg","catch","toggleLoginType","resetLoginFormValidation","showForgotPassword","$nextTick","resetForgotPasswordFormValidation","showLoginForm","clearValidate","sendCode","timer","setInterval","clearInterval","sendVerifyCode","submitVerifyCode","put"],"sources":["src/views/Login.vue"],"sourcesContent":["<template>\r\n  <div class=\"login-container\">\r\n    <!-- 登录表单，通过 isLoginFormVisible 控制显示隐藏 -->\r\n    <div v-if=\"isLoginFormVisible\">\r\n      <el-form\r\n        :model=\"loginForm\"\r\n        ref=\"loginFormRef\"\r\n        label-width=\"80px\"\r\n        :rules=\"loginFormRules\"\r\n      >\r\n        <h2 class=\"title\">登录</h2>\r\n        <span class=\"hint-text\" v-if=\"!isPasswordLogin\"\r\n          >（用户初次使用该方式视为注册，密码需要到个人信息页面设置）</span\r\n        >\r\n        <el-form-item label=\"邮箱\" prop=\"email\">\r\n          <el-input v-model=\"loginForm.email\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"密码\" v-if=\"isPasswordLogin\" prop=\"password\">\r\n          <el-input v-model=\"loginForm.password\" type=\"password\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item\r\n          label=\"验证码\"\r\n          v-if=\"!isPasswordLogin\"\r\n          prop=\"verificationCode\"\r\n        >\r\n          <el-input v-model=\"loginForm.verificationCode\"></el-input>\r\n          <el-button @click=\"sendCode\" :disabled=\"isSendingCode\">\r\n            {{ isSendingCode ? `重新发送(${countdown}s)` : \"发送验证码\" }}\r\n          </el-button>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"submitLogin\">登录</el-button>\r\n          <el-button @click=\"toggleLoginType\">\r\n            切换到 {{ isPasswordLogin ? \"验证码登录\" : \"密码登录\" }}\r\n          </el-button>\r\n          <el-button @click=\"showForgotPassword\">忘记密码</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n\r\n    <!-- 忘记密码表单，通过 isForgotPasswordFormVisible 控制显示隐藏 -->\r\n    <div v-if=\"isForgotPasswordFormVisible\">\r\n      <el-form\r\n        :model=\"forgotPasswordForm\"\r\n        ref=\"forgotPasswordFormRef\"\r\n        label-width=\"80px\"\r\n        :rules=\"forgotPasswordFormRules\"\r\n      >\r\n        <h2 class=\"title\">重置密码</h2>\r\n\r\n        <el-form-item label=\"邮箱\" prop=\"email\">\r\n          <el-input v-model=\"forgotPasswordForm.email\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item\r\n          v-if=\"!isNewPasswordInputVisible\"\r\n          label=\"验证码\"\r\n          prop=\"verificationCode\"\r\n        >\r\n          <el-input v-model=\"forgotPasswordForm.verificationCode\"></el-input>\r\n          <el-button @click=\"sendVerifyCode\" :disabled=\"isSendingVerifyCode\">\r\n            {{\r\n              isSendingVerifyCode\r\n                ? `重新发送(${countdownVerify}s)`\r\n                : \"发送验证码\"\r\n            }}\r\n          </el-button>\r\n          <el-button type=\"primary\" @click=\"submitVerifyCode\"\r\n            >提交验证码</el-button\r\n          >\r\n          <el-button v-if=\"!isNewPasswordInputVisible\" @click=\"showLoginForm\"\r\n            >返回登录</el-button\r\n          ></el-form-item\r\n        >\r\n        <el-form-item\r\n          v-if=\"isNewPasswordInputVisible\"\r\n          label=\"新密码\"\r\n          prop=\"newPassword\"\r\n        >\r\n          <el-input\r\n            v-model=\"forgotPasswordForm.newPassword\"\r\n            type=\"password\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item v-if=\"isNewPasswordInputVisible\">\r\n          <el-button type=\"primary\" @click=\"submitResetPassword\"\r\n            >重置密码</el-button\r\n          >\r\n          <el-button @click=\"showLoginForm\">返回登录</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport request from \"../utils/request\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      isPasswordLogin: true,\r\n      isLoginFormVisible: true,\r\n      isNewPasswordInputVisible: false,\r\n      isForgotPasswordFormVisible: false,\r\n      loginForm: {\r\n        email: \"\",\r\n        password: \"\",\r\n        verificationCode: \"\",\r\n      },\r\n      forgotPasswordForm: {\r\n        email: \"\",\r\n        verificationCode: \"\",\r\n        newPassword: \"\",\r\n      },\r\n      loginFormRules: {\r\n        email: [\r\n          { required: true, message: \"请输入邮箱\", trigger: \"blur\" },\r\n          {\r\n            pattern: /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/,\r\n            message: \"邮箱格式不正确\",\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n        password: [{ required: true, message: \"请输入密码\", trigger: \"blur\" }],\r\n        verificationCode: [\r\n          { required: true, message: \"请输入验证码\", trigger: \"blur\" },\r\n          { min: 6, max: 6, message: \"验证码长度必须为6\", trigger: \"blur\" },\r\n        ],\r\n      },\r\n      forgotPasswordFormRules: {\r\n        email: [\r\n          { required: true, message: \"请输入邮箱\", trigger: \"blur\" },\r\n          {\r\n            pattern: /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/,\r\n            message: \"邮箱格式不正确\",\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n        verificationCode: [\r\n          { required: true, message: \"请输入验证码\", trigger: \"blur\" },\r\n          { min: 6, max: 6, message: \"验证码长度必须为6\", trigger: \"blur\" },\r\n        ],\r\n        newPassword: [\r\n          { required: true, message: \"请输入新密码\", trigger: \"blur\" },\r\n        ],\r\n      },\r\n      isSendingCode: false, // 登录验证码发送状态\r\n      isSendingVerifyCode: false, // 忘记密码的验证码发送状态\r\n      countdown: 60,\r\n      countdownVerify: 60,\r\n      sentCodeTime: null, // 登录验证码发送时间\r\n      verifyCodeTime: null, // 忘记密码的验证码发送时间\r\n    };\r\n  },\r\n  methods: {\r\n    submitLogin() {\r\n      this.$refs.loginFormRef.validate((valid) => {\r\n        if (valid) {\r\n          if (!this.isPasswordLogin) {\r\n            const currentTime = Date.now();\r\n            if (\r\n              this.sentCodeTime &&\r\n              currentTime - this.sentCodeTime > 60 * 1000\r\n            ) {\r\n              this.$message.error(\"验证码已过期，请重新获取\");\r\n              return;\r\n            }\r\n          }\r\n          this.login();\r\n        } else {\r\n          console.log(\"表单校验不通过\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n\r\n    submitResetPassword() {\r\n      this.$refs.forgotPasswordFormRef.validate((valid) => {\r\n        if (valid) {\r\n          const currentTime = Date.now();\r\n          if (\r\n            this.verifyCodeTime &&\r\n            currentTime - this.verifyCodeTime > 60 * 1000\r\n          ) {\r\n            this.$message.error(\"验证码已过期，请重新获取\");\r\n            return;\r\n          }\r\n          this.resetPassword();\r\n        } else {\r\n          console.log(\"表单校验不通过\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n\r\n    login() {\r\n      if (this.isPasswordLogin) {\r\n        // 密码登录\r\n        request\r\n          .post(\"/users/loginByPassword\", {\r\n            email: this.loginForm.email,\r\n            password: this.loginForm.password,\r\n          })\r\n          .then((response) => {\r\n            if (response.code === 200) {\r\n              const { refreshToken, accessToken } = response.data;\r\n              //删去临时token\r\n              localStorage.removeItem(\"templeAccessToken\");\r\n              // 存储 refreshToken 到 localStorage\r\n              localStorage.setItem(\"refreshToken\", refreshToken);\r\n              // 存储 accessToken 到 localStorage\r\n              localStorage.setItem(\"accessToken\", accessToken);\r\n              // 存储用户信息到 localStorage\r\n              localStorage.setItem(\"userEmail\", this.loginForm.email);\r\n              this.$message.success(\"登录成功\");\r\n              // 页面跳转\r\n              this.$router.push(\"/create\");\r\n            } else {\r\n              this.$message.error(response.msg);\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            // 处理登录失败逻辑\r\n            console.log(error);\r\n            this.$message.error(\"登录失败!\");\r\n          });\r\n      } else {\r\n        // 验证码登录\r\n        request\r\n          .post(\"/users/loginByEmail\", {\r\n            email: this.loginForm.email,\r\n            verificationCode: this.loginForm.verificationCode,\r\n          })\r\n          .then((response) => {\r\n            if (response.code === 200) {\r\n              const { refreshToken, accessToken } = response.data;\r\n              //删去临时token\r\n              localStorage.removeItem(\"templeAccessToken\");\r\n              // 存储 refreshToken 到 localStorage\r\n              localStorage.setItem(\"refreshToken\", refreshToken);\r\n              // 存储 accessToken 到 localStorage\r\n              localStorage.setItem(\"accessToken\", accessToken);\r\n              // 存储用户信息到 localStorage\r\n              localStorage.setItem(\"userEmail\", this.loginForm.email);\r\n              this.$message.success(\"登录成功\");\r\n              // 页面跳转\r\n              this.$router.push(\"/create\");\r\n            } else {\r\n              this.$message.error(response.msg);\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            // 处理登录失败逻辑\r\n            console.log(error);\r\n            this.$message.error(\"登陆失败！\");\r\n          });\r\n      }\r\n    },\r\n\r\n    toggleLoginType() {\r\n      this.isPasswordLogin = !this.isPasswordLogin;\r\n      // 切换登录方式时重置验证码时间和状态\r\n      this.sentCodeTime = null;\r\n      this.isSendingCode = false;\r\n      this.countdown = 60;\r\n      this.loginForm.verificationCode = \"\";\r\n\r\n      // 重置表单校验状态\r\n      this.resetLoginFormValidation();\r\n    },\r\n\r\n    showForgotPassword() {\r\n      // 先重置登录表单校验\r\n      this.resetLoginFormValidation();\r\n\r\n      this.isLoginFormVisible = false;\r\n      this.isForgotPasswordFormVisible = true;\r\n      this.isNewPasswordInputVisible = false;\r\n\r\n      // 重置忘记密码表单\r\n      this.$nextTick(() => {\r\n        this.resetForgotPasswordFormValidation();\r\n        this.forgotPasswordForm = {\r\n          email: this.loginForm.email, // 保留邮箱\r\n          verificationCode: \"\",\r\n          newPassword: \"\",\r\n        };\r\n      });\r\n    },\r\n\r\n    showLoginForm() {\r\n      // 先重置忘记密码表单校验\r\n      this.resetForgotPasswordFormValidation();\r\n\r\n      this.isLoginFormVisible = true;\r\n      this.isForgotPasswordFormVisible = false;\r\n      this.isNewPasswordInputVisible = false;\r\n\r\n      // 重置登录表单\r\n      this.$nextTick(() => {\r\n        this.resetLoginFormValidation();\r\n      });\r\n    },\r\n\r\n    // 新增方法：重置登录表单校验\r\n    resetLoginFormValidation() {\r\n      this.$nextTick(() => {\r\n        if (this.$refs.loginFormRef) {\r\n          this.$refs.loginFormRef.clearValidate();\r\n          // 如果想同时重置字段值，可以使用：\r\n          // this.$refs.loginFormRef.resetFields();\r\n        }\r\n      });\r\n    },\r\n\r\n    // 重置忘记密码表单校验\r\n    resetForgotPasswordFormValidation() {\r\n      this.$nextTick(() => {\r\n        if (this.$refs.forgotPasswordFormRef) {\r\n          this.$refs.forgotPasswordFormRef.clearValidate();\r\n          // 如果想同时重置字段值，可以使用：\r\n          // this.$refs.forgotPasswordFormRef.resetFields();\r\n        }\r\n      });\r\n    },\r\n\r\n    // 登录验证码\r\n    sendCode() {\r\n      if (this.isSendingCode) return;\r\n      this.isSendingCode = true;\r\n      request\r\n        .post(`/users/email?email=${this.loginForm.email}`)\r\n        .then((response) => {\r\n          // 处理发送验证码成功逻辑\r\n          if (response.code === 200) {\r\n            this.$message.success(\"验证码已发送\");\r\n            this.sentCodeTime = Date.now();\r\n            let timer = setInterval(() => {\r\n              if (this.countdown > 0) {\r\n                this.countdown--;\r\n              } else {\r\n                clearInterval(timer);\r\n                this.isSendingCode = false;\r\n                this.countdown = 60;\r\n              }\r\n            }, 1000);\r\n          } else {\r\n            this.isSendingCode = false;\r\n            this.$message.error(response.msg);\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          // 处理发送验证码失败逻辑\r\n          this.$message.error(\"验证码发送失败，请稍后重试\");\r\n          this.isSendingCode = false;\r\n          this.countdown = 60;\r\n        });\r\n    },\r\n\r\n    //通过验证码登录\r\n    sendVerifyCode() {\r\n      if (this.isSendingVerifyCode) return;\r\n      this.isSendingVerifyCode = true;\r\n      request\r\n        .post(`/users/email?email=${this.forgotPasswordForm.email}`)\r\n        .then((response) => {\r\n          // 处理发送验证邮件成功逻辑\r\n          if (response.code == 200) {\r\n            this.$message.success(\"验证码已发送\");\r\n            this.verifyCodeTime = Date.now();\r\n            let timer = setInterval(() => {\r\n              if (this.countdownVerify > 0) {\r\n                this.countdownVerify--;\r\n              } else {\r\n                clearInterval(timer);\r\n                this.isSendingVerifyCode = false;\r\n                this.countdownVerify = 60;\r\n              }\r\n            }, 1000);\r\n          } else {\r\n            this.isSendingVerifyCode = false;\r\n            this.$message.error(response.msg);\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          // 处理发送验证邮件失败逻辑\r\n          this.$message.error(\"验证邮件发送失败，请稍后重试\");\r\n          this.isSendingVerifyCode = false;\r\n          this.countdownVerify = 60;\r\n        });\r\n    },\r\n\r\n    submitVerifyCode() {\r\n      this.$refs.forgotPasswordFormRef.validate((valid) => {\r\n        if (valid) {\r\n          // 检查验证码是否过期\r\n          const currentTime = Date.now();\r\n          if (\r\n            this.verifyCodeTime &&\r\n            currentTime - this.verifyCodeTime > 60 * 1000\r\n          ) {\r\n            this.$message.error(\"验证码已过期，请重新获取\");\r\n            return;\r\n          }\r\n\r\n          request\r\n            .put(\"/users/verify\", {\r\n              email: this.forgotPasswordForm.email,\r\n              verificationCode: this.forgotPasswordForm.verificationCode,\r\n            })\r\n            .then((response) => {\r\n              if (response.code === 200) {\r\n                this.isNewPasswordInputVisible = true;\r\n                localStorage.setItem(\"templeAccessToken\", response.msg);\r\n              } else {\r\n                this.$message.error(response.msg);\r\n              }\r\n            })\r\n            .catch((error) => {\r\n              console.log(error);\r\n            });\r\n        } else {\r\n          console.log(\"表单校验不通过\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    resetPassword() {\r\n      request\r\n        .put(\r\n          `/users/resetPassword?password=${this.forgotPasswordForm.newPassword}`\r\n        )\r\n        .then((response) => {\r\n          // 处理重置密码成功逻辑\r\n          if (response.code === 200) {\r\n            this.isForgotPasswordFormVisible = false;\r\n            this.isLoginFormVisible = true;\r\n          } else {\r\n            this.$message.error(response.msg);\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          // 处理重置密码失败逻辑\r\n          console.log(error);\r\n        });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nh2 {\r\n  padding: 0;\r\n  text-align: center;\r\n  color: #333;\r\n}\r\n\r\n.login-container {\r\n  min-height: 100vh;\r\n  background-color: #f4f4f4;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.login-container > div {\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.el-form {\r\n  width: 50%;\r\n  background-color: white;\r\n  padding: 20px;\r\n  border-radius: 5px;\r\n  box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.el-input {\r\n  width: calc(100% - 18px);\r\n  padding: 8px;\r\n  margin-bottom: 10px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 3px;\r\n}\r\n\r\n.el-button {\r\n  margin: 5px;\r\n  padding: 8px 15px;\r\n  border: none;\r\n  border-radius: 3px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s ease;\r\n}\r\n\r\n.el-button--primary {\r\n  background-color: #42b983;\r\n  color: white;\r\n}\r\n\r\n.el-button--primary:hover {\r\n  background-color: #37a373;\r\n}\r\n\r\n.el-button--default {\r\n  background-color: #f4f4f4;\r\n  color: #333;\r\n}\r\n\r\n.el-button--default:hover {\r\n  background-color: #e9e9e9;\r\n}\r\n\r\n.hint-text {\r\n  display: block;\r\n  margin-bottom: 10px;\r\n  color: #666;\r\n  font-size: 12px;\r\n}\r\n\r\n.el-form-item__error {\r\n  color: #f56c6c;\r\n  font-size: 12px;\r\n  margin-top: 3px;\r\n}\r\n</style>\r\n"],"mappings":";AA+FA,OAAAA,OAAA;AAEA;EACAC,KAAA;IACA;MACAC,eAAA;MACAC,kBAAA;MACAC,yBAAA;MACAC,2BAAA;MACAC,SAAA;QACAC,KAAA;QACAC,QAAA;QACAC,gBAAA;MACA;MACAC,kBAAA;QACAH,KAAA;QACAE,gBAAA;QACAE,WAAA;MACA;MACAC,cAAA;QACAL,KAAA,GACA;UAAAM,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UACAC,OAAA;UACAF,OAAA;UACAC,OAAA;QACA,EACA;QACAP,QAAA;UAAAK,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAN,gBAAA,GACA;UAAAI,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAE,GAAA;UAAAC,GAAA;UAAAJ,OAAA;UAAAC,OAAA;QAAA;MAEA;MACAI,uBAAA;QACAZ,KAAA,GACA;UAAAM,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UACAC,OAAA;UACAF,OAAA;UACAC,OAAA;QACA,EACA;QACAN,gBAAA,GACA;UAAAI,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAE,GAAA;UAAAC,GAAA;UAAAJ,OAAA;UAAAC,OAAA;QAAA,EACA;QACAJ,WAAA,GACA;UAAAE,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;MAEA;MACAK,aAAA;MAAA;MACAC,mBAAA;MAAA;MACAC,SAAA;MACAC,eAAA;MACAC,YAAA;MAAA;MACAC,cAAA;IACA;EACA;EACAC,OAAA;IACAC,YAAA;MACA,KAAAC,KAAA,CAAAC,YAAA,CAAAC,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACA,UAAA7B,eAAA;YACA,MAAA8B,WAAA,GAAAC,IAAA,CAAAC,GAAA;YACA,IACA,KAAAV,YAAA,IACAQ,WAAA,QAAAR,YAAA,cACA;cACA,KAAAW,QAAA,CAAAC,KAAA;cACA;YACA;UACA;UACA,KAAAC,KAAA;QACA;UACAC,OAAA,CAAAC,GAAA;UACA;QACA;MACA;IACA;IAEAC,oBAAA;MACA,KAAAZ,KAAA,CAAAa,qBAAA,CAAAX,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACA,MAAAC,WAAA,GAAAC,IAAA,CAAAC,GAAA;UACA,IACA,KAAAT,cAAA,IACAO,WAAA,QAAAP,cAAA,cACA;YACA,KAAAU,QAAA,CAAAC,KAAA;YACA;UACA;UACA,KAAAM,aAAA;QACA;UACAJ,OAAA,CAAAC,GAAA;UACA;QACA;MACA;IACA;IAEAF,MAAA;MACA,SAAAnC,eAAA;QACA;QACAF,OAAA,CACA2C,IAAA;UACApC,KAAA,OAAAD,SAAA,CAAAC,KAAA;UACAC,QAAA,OAAAF,SAAA,CAAAE;QACA,GACAoC,IAAA,CAAAC,QAAA;UACA,IAAAA,QAAA,CAAAC,IAAA;YACA;cAAAC,YAAA;cAAAC;YAAA,IAAAH,QAAA,CAAA5C,IAAA;YACA;YACAgD,YAAA,CAAAC,UAAA;YACA;YACAD,YAAA,CAAAE,OAAA,iBAAAJ,YAAA;YACA;YACAE,YAAA,CAAAE,OAAA,gBAAAH,WAAA;YACA;YACAC,YAAA,CAAAE,OAAA,mBAAA7C,SAAA,CAAAC,KAAA;YACA,KAAA4B,QAAA,CAAAiB,OAAA;YACA;YACA,KAAAC,OAAA,CAAAC,IAAA;UACA;YACA,KAAAnB,QAAA,CAAAC,KAAA,CAAAS,QAAA,CAAAU,GAAA;UACA;QACA,GACAC,KAAA,CAAApB,KAAA;UACA;UACAE,OAAA,CAAAC,GAAA,CAAAH,KAAA;UACA,KAAAD,QAAA,CAAAC,KAAA;QACA;MACA;QACA;QACApC,OAAA,CACA2C,IAAA;UACApC,KAAA,OAAAD,SAAA,CAAAC,KAAA;UACAE,gBAAA,OAAAH,SAAA,CAAAG;QACA,GACAmC,IAAA,CAAAC,QAAA;UACA,IAAAA,QAAA,CAAAC,IAAA;YACA;cAAAC,YAAA;cAAAC;YAAA,IAAAH,QAAA,CAAA5C,IAAA;YACA;YACAgD,YAAA,CAAAC,UAAA;YACA;YACAD,YAAA,CAAAE,OAAA,iBAAAJ,YAAA;YACA;YACAE,YAAA,CAAAE,OAAA,gBAAAH,WAAA;YACA;YACAC,YAAA,CAAAE,OAAA,mBAAA7C,SAAA,CAAAC,KAAA;YACA,KAAA4B,QAAA,CAAAiB,OAAA;YACA;YACA,KAAAC,OAAA,CAAAC,IAAA;UACA;YACA,KAAAnB,QAAA,CAAAC,KAAA,CAAAS,QAAA,CAAAU,GAAA;UACA;QACA,GACAC,KAAA,CAAApB,KAAA;UACA;UACAE,OAAA,CAAAC,GAAA,CAAAH,KAAA;UACA,KAAAD,QAAA,CAAAC,KAAA;QACA;MACA;IACA;IAEAqB,gBAAA;MACA,KAAAvD,eAAA,SAAAA,eAAA;MACA;MACA,KAAAsB,YAAA;MACA,KAAAJ,aAAA;MACA,KAAAE,SAAA;MACA,KAAAhB,SAAA,CAAAG,gBAAA;;MAEA;MACA,KAAAiD,wBAAA;IACA;IAEAC,mBAAA;MACA;MACA,KAAAD,wBAAA;MAEA,KAAAvD,kBAAA;MACA,KAAAE,2BAAA;MACA,KAAAD,yBAAA;;MAEA;MACA,KAAAwD,SAAA;QACA,KAAAC,iCAAA;QACA,KAAAnD,kBAAA;UACAH,KAAA,OAAAD,SAAA,CAAAC,KAAA;UAAA;UACAE,gBAAA;UACAE,WAAA;QACA;MACA;IACA;IAEAmD,cAAA;MACA;MACA,KAAAD,iCAAA;MAEA,KAAA1D,kBAAA;MACA,KAAAE,2BAAA;MACA,KAAAD,yBAAA;;MAEA;MACA,KAAAwD,SAAA;QACA,KAAAF,wBAAA;MACA;IACA;IAEA;IACAA,yBAAA;MACA,KAAAE,SAAA;QACA,SAAAhC,KAAA,CAAAC,YAAA;UACA,KAAAD,KAAA,CAAAC,YAAA,CAAAkC,aAAA;UACA;UACA;QACA;MACA;IACA;IAEA;IACAF,kCAAA;MACA,KAAAD,SAAA;QACA,SAAAhC,KAAA,CAAAa,qBAAA;UACA,KAAAb,KAAA,CAAAa,qBAAA,CAAAsB,aAAA;UACA;UACA;QACA;MACA;IACA;IAEA;IACAC,SAAA;MACA,SAAA5C,aAAA;MACA,KAAAA,aAAA;MACApB,OAAA,CACA2C,IAAA,4BAAArC,SAAA,CAAAC,KAAA,IACAqC,IAAA,CAAAC,QAAA;QACA;QACA,IAAAA,QAAA,CAAAC,IAAA;UACA,KAAAX,QAAA,CAAAiB,OAAA;UACA,KAAA5B,YAAA,GAAAS,IAAA,CAAAC,GAAA;UACA,IAAA+B,KAAA,GAAAC,WAAA;YACA,SAAA5C,SAAA;cACA,KAAAA,SAAA;YACA;cACA6C,aAAA,CAAAF,KAAA;cACA,KAAA7C,aAAA;cACA,KAAAE,SAAA;YACA;UACA;QACA;UACA,KAAAF,aAAA;UACA,KAAAe,QAAA,CAAAC,KAAA,CAAAS,QAAA,CAAAU,GAAA;QACA;MACA,GACAC,KAAA,CAAApB,KAAA;QACA;QACA,KAAAD,QAAA,CAAAC,KAAA;QACA,KAAAhB,aAAA;QACA,KAAAE,SAAA;MACA;IACA;IAEA;IACA8C,eAAA;MACA,SAAA/C,mBAAA;MACA,KAAAA,mBAAA;MACArB,OAAA,CACA2C,IAAA,4BAAAjC,kBAAA,CAAAH,KAAA,IACAqC,IAAA,CAAAC,QAAA;QACA;QACA,IAAAA,QAAA,CAAAC,IAAA;UACA,KAAAX,QAAA,CAAAiB,OAAA;UACA,KAAA3B,cAAA,GAAAQ,IAAA,CAAAC,GAAA;UACA,IAAA+B,KAAA,GAAAC,WAAA;YACA,SAAA3C,eAAA;cACA,KAAAA,eAAA;YACA;cACA4C,aAAA,CAAAF,KAAA;cACA,KAAA5C,mBAAA;cACA,KAAAE,eAAA;YACA;UACA;QACA;UACA,KAAAF,mBAAA;UACA,KAAAc,QAAA,CAAAC,KAAA,CAAAS,QAAA,CAAAU,GAAA;QACA;MACA,GACAC,KAAA,CAAApB,KAAA;QACA;QACA,KAAAD,QAAA,CAAAC,KAAA;QACA,KAAAf,mBAAA;QACA,KAAAE,eAAA;MACA;IACA;IAEA8C,iBAAA;MACA,KAAAzC,KAAA,CAAAa,qBAAA,CAAAX,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACA;UACA,MAAAC,WAAA,GAAAC,IAAA,CAAAC,GAAA;UACA,IACA,KAAAT,cAAA,IACAO,WAAA,QAAAP,cAAA,cACA;YACA,KAAAU,QAAA,CAAAC,KAAA;YACA;UACA;UAEApC,OAAA,CACAsE,GAAA;YACA/D,KAAA,OAAAG,kBAAA,CAAAH,KAAA;YACAE,gBAAA,OAAAC,kBAAA,CAAAD;UACA,GACAmC,IAAA,CAAAC,QAAA;YACA,IAAAA,QAAA,CAAAC,IAAA;cACA,KAAA1C,yBAAA;cACA6C,YAAA,CAAAE,OAAA,sBAAAN,QAAA,CAAAU,GAAA;YACA;cACA,KAAApB,QAAA,CAAAC,KAAA,CAAAS,QAAA,CAAAU,GAAA;YACA;UACA,GACAC,KAAA,CAAApB,KAAA;YACAE,OAAA,CAAAC,GAAA,CAAAH,KAAA;UACA;QACA;UACAE,OAAA,CAAAC,GAAA;UACA;QACA;MACA;IACA;IACAG,cAAA;MACA1C,OAAA,CACAsE,GAAA,CACA,sCAAA5D,kBAAA,CAAAC,WAAA,EACA,EACAiC,IAAA,CAAAC,QAAA;QACA;QACA,IAAAA,QAAA,CAAAC,IAAA;UACA,KAAAzC,2BAAA;UACA,KAAAF,kBAAA;QACA;UACA,KAAAgC,QAAA,CAAAC,KAAA,CAAAS,QAAA,CAAAU,GAAA;QACA;MACA,GACAC,KAAA,CAAApB,KAAA;QACA;QACAE,OAAA,CAAAC,GAAA,CAAAH,KAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}